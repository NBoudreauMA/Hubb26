<td class="category-name">Personnel (Town)</td>
                                <td>$2,156,210</td>
                                <td>$2,214,752</td>
                                <td>$2,275,757</td>
                                <td>$2,338,489</td>
                                <td>$2,402,998</td>
                                <td>$2,469,542</td>
                            </tr>
                            <tr>
                                <td class="category-name">Services (Town)</td>
                                <td>$168,618</td>
                                <td>$171,729</td>
                                <td>$174,362</td>
                                <td>$177,059</td>
                                <td>$179,821</td>
                                <td>$182,896</td>
                            </tr>
                            <tr>
                                <td class="category-name">Facilities, Utilities, Gear, Supplies, and Capital</td>
                                <td>$755,459</td>
                                <td>$766,099</td>
                                <td>$786,171</td>
                                <td>$806,815</td>
                                <td>$828,049</td>
                                <td>$850,107</td>
                            </tr>
                            <tr>
                                <td class="category-name">Education</td>
                                <td>$6,784,230</td>
                                <td>$7,334,563</td>
                                <td>$7,566,285</td>
                                <td>$7,937,654</td>
                                <td>$8,327,402</td>
                                <td>$8,736,444</td>
                            </tr>
                            <tr>
                                <td class="category-name">Liabilities (Insurances and Assessments)</td>
                                <td>$1,036,256</td>
                                <td>$999,455</td>
                                <td>$1,138,701</td>
                                <td>$1,186,745</td>
                                <td>$1,236,966</td>
                                <td>$1,289,466</td>
                            </tr>
                            <tr>
                                <td class="category-name">Debt</td>
                                <td>$146,862</td>
                                <td>$146,862</td>
                                <td>$157,681</td>
                                <td>$160,834</td>
                                <td>$164,051</td>
                                <td>$167,332</td>
                            </tr>
                            <tr class="total-row">
                                <td class="category-name">TOTAL</td>
                                <td>$11,047,636</td>
                                <td>$11,851,233</td>
                                <td>$12,098,956</td>
                                <td>$12,607,597</td>
                                <td>$13,139,288</td>
                                <td>$13,695,787</td>
                            </tr>
                            <tr class="diff-row">
                                <td class="category-name">Annual Increase</td>
                                <td>-</td>
                                <td>$803,597</td>
                                <td>$247,723</td>
                                <td>$508,640</td>
                                <td>$531,692</td>
                                <td>$556,498</td>
                            </tr>
                            <tr class="diff-row">
                                <td class="category-name">Annual % Increase</td>
                                <td>-</td>
                                <td>7.27%</td>
                                <td>2.09%</td>
                                <td>4.20%</td>
                                <td>4.22%</td>
                                <td>4.23%</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Department Breakdown -->
            <div class="budget-forecast">
                <h3 class="forecast-title">FY26 Department Breakdown</h3>
                
                <div class="forecast-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Department</th>
                                <th>Description</th>
                                <th>FY25</th>
                                <th>FY26</th>
                                <th>Change</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="category-name">Select Board & Town Admin</td>
                                <td>Executive leadership, legal services</td>
                                <td>$195,873</td>
                                <td>$199,790</td>
                                <td class="increase">+$3,917</td>
                            </tr>
                            <tr>
                                <td class="category-name">Finance & Administration</td>
                                <td>Accounting, IT, Assessors, Treasury</td>
                                <td>$343,443</td>
                                <td>$352,754</td>
                                <td class="increase">+$9,311</td>
                            </tr>
                            <tr>
                                <td class="category-name">Town Clerk</td>
                                <td>Records, elections, licensing</td>
                                <td>$70,950</td>
                                <td>$72,369</td>
                                <td class="increase">+$1,419</td>
                            </tr>
                            <tr>
                                <td class="category-name">Police Department</td>
                                <td>Law enforcement, public safety</td>
                                <td>$697,526</td>
                                <td>$713,402</td>
                                <td class="increase">+$15,876</td>
                            </tr>
                            <tr>
                                <td class="category-name">Fire Department</td>
                                <td>Fire protection, EMS services</td>
                                <td>$588,187</td>
                                <td>$579,780</td>
                                <td class="increase">-$8,407</td>
                            </tr>
                            <tr>
                                <td class="category-name">Public Works</td>
                                <td>Roads, facilities, snow removal</td>
                                <td>$905,481</td>
                                <td>$939,623</td>
                                <td class="increase">+$34,142</td>
                            </tr>
                            <tr>
                                <td class="category-name">Education</td>
                                <td>School district assessments</td>
                                <td>$6,784,230</td>
                                <td>$7,334,563</td>
                                <td class="increase">+$550,333</td>
                            </tr>
                            <tr>
                                <td class="category-name">Culture & Recreation</td>
                                <td>Library, parks, historical</td>
                                <td>$92,544</td>
                                <td>$94,335</td>
                                <td class="increase">+$1,791</td>
                            </tr>
                            <tr>
                                <td class="category-name">Human Services</td>
                                <td>Senior services, veterans</td>
                                <td>$31,454</td>
                                <td>$32,083</td>
                                <td class="increase">+$629</td>
                            </tr>
                            <tr class="total-row">
                                <td class="category-name" colspan="2">TOTAL BUDGET</td>
                                <td>$11,047,636</td>
                                <td>$11,851,233</td>
                                <td class="increase">+$803,597</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Download Buttons -->
            <div class="button-container">
                <a href="expenditures_detail.pdf" target="_blank" class="download-button">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="button-icon">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                        <polyline points="7 10 12 15 17 10"></polyline>
                        <line x1="12" y1="15" x2="12" y2="3"></line>
                    </svg>
                    Download Detailed Report
                </a>
                
                <a href="budget_spreadsheet.xlsx" target="_blank" class="download-button">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="button-icon">
                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                        <line x1="9" y1="3" x2="9" y2="21"></line>
                        <line x1="15" y1="3" x2="15" y2="21"></line>
                        <line x1="3" y1="9" x2="21" y2="9"></line>
                        <line x1="3" y1="15" x2="21" y2="15"></line>
                    </svg>
                    Download Budget Spreadsheet
                </a>
            </div>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Set consistent colors for department categories
            const departmentColors = {
                education: '#3498db',
                publicSafety: '#e74c3c',
                liabilities: '#9b59b6',
                publicWorks: '#1abc9c',
                generalGov: '#f1c40f',
                debt: '#e67e22',
                culture: '#00bcd4',
                humanServices: '#ff80ab'
            };
            
            // Department Expenditures Chart
            const deptCtx = document.getElementById('departmentChart').getContext('2d');
            new Chart(deptCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Education', 'Public Safety', 'Liabilities & Assessments', 'Public Works', 'General Government', 'Debt Service', 'Culture & Recreation', 'Human Services'],
                    datasets: [{
                        data: [7334563, 1595193, 999455, 920184, 724886, 146862, 94290, 26950],
                        backgroundColor: [
                            departmentColors.education,
                            departmentColors.publicSafety,
                            departmentColors.liabilities,
                            departmentColors.publicWorks, 
                            departmentColors.generalGov,
                            departmentColors.debt,
                            departmentColors.culture,
                            departmentColors.humanServices
                        ],
                        borderWidth: 0,
                        hoverOffset: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const value = context.raw;
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const percentage = Math.round((value / total * 100) * 10) / 10;
                                    const formattedValue = new Intl.NumberFormat('en-US', {
                                        style: 'currency',
                                        currency: 'USD',
                                        maximumFractionDigits: 0
                                    }).format(value);
                                    return `${context.label}: ${formattedValue} (${percentage}%)`;
                                }
                            }
                        }
                    },
                    cutout: '60%',
                    animation: {
                        animateScale: true,
                        animateRotate: true
                    }
                }
            });
            
            // Budget Categories Chart
            const catCtx = document.getElementById('categoriesChart').getContext('2d');
            new Chart(catCtx, {
                type: 'bar',
                data: {
                    labels: ['Personnel', 'Education', 'Facilities & Supplies', 'Services', 'Liabilities'],
                    datasets: [{
                        label: 'FY26 Budget Allocation',
                        data: [2214752, 7334563, 766099, 171729, 1087734],
                        backgroundColor: [
                            '#3498db',
                            '#1abc9c',
                            '#9b59b6',
                            '#f1c40f',
                            '#e74c3c'
                        ],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            ticks: {
                                color: '#ffffff',
                                callback: function(value) {
                                    if (value >= 1000000) {
                                        return '$' + (value / 1000000).toFixed(1) + 'M';
                                    }
                                    return '$' + value.toLocaleString();
                                }
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                color: '#ffffff'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const value = context.raw;
                                    const formattedValue = new Intl.NumberFormat('en-US', {
                                        style: 'currency',
                                        currency: 'USD',
                                        maximumFractionDigits: 0
                                    }).format(value);
                                    return `Amount: ${formattedValue}`;
                                }
                            }
                        }
                    },
                    animation: {
                        animateScale: true
                    }
                }
            });
            
            // Five-Year Forecast Chart
            const forecastCtx = document.getElementById('forecastChart').getContext('2d');
            new Chart(forecastCtx, {
                type: 'line',
                data: {
                    labels: ['FY25', 'FY26', 'FY27', 'FY28', 'FY29', 'FY30'],
                    datasets: [
                        {
                            label: 'Education',
                            data: [6784230, 7334563, 7566285, 7937654, 8327402, 8736444],
                            borderColor: departmentColors.education,
                            backgroundColor: 'rgba(52, 152, 219, 0.1)',
                            fill: true,
                            tension: 0.4,
                            borderWidth: 3
                        },
                        {
                            label: 'Personnel',
                            data: [2156210, 2214752, 2275757, 2338489, 2402998, 2469542],
                            borderColor: departmentColors.publicSafety,
                            backgroundColor: 'rgba(231, 76, 60, 0.1)',
                            fill: true,
                            tension: 0.4,
                            borderWidth: 3
                        },
                        {
                            label: 'Liabilities',
                            data: [1036256, 999455, 1138701, 1186745, 1236966, 1289466],
                            borderColor: departmentColors.liabilities,
                            backgroundColor: 'rgba(155, 89, 182, 0.1)',
                            fill: true,
                            tension: 0.4,
                            borderWidth: 3
                        },
                        {
                            label: 'Facilities & Supplies',
                            data: [755459, 766099, 786171, 806815, 828049, 850107],
                            borderColor: departmentColors.publicWorks,
                            backgroundColor: 'rgba(26, 188, 156, 0.1)',
                            fill: true,
                            tension: 0.4,
                            borderWidth: 3
                        },
                        {
                            label: 'Total Budget',
                            data: [11047636, 11851233, 12098956, 12607597, 13139288, 13695787],
                            borderColor: '#4bc0c0',
                            backgroundColor: 'rgba(75, 192, 192, 0.1)',
                            borderDash: [5, 5],
                            borderWidth: 3,
                            fill: false,
                            tension: 0.4,
                            pointRadius: 5,
                            pointHoverRadius: 8
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            ticks: {
                                color: '#ffffff',
                                callback: function(value) {
                                    if (value >= 1000000) {
                                        return '$' + (value / 1000000).toFixed(1) + 'M';
                                    }
                                    return '$' + value.toLocaleString();
                                }
                            }
                        },
                        x: {
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            ticks: {
                                color: '#ffffff'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                color: '#ffffff',
                                font: {
                                    family: 'Poppins',
                                    size: 12
                                },
                                boxWidth: 12
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const value = context.raw;
                                    const formattedValue = new Intl.NumberFormat('en-US', {
                                        style: 'currency',
                                        currency: 'USD',
                                        maximumFractionDigits: 0
                                    }).format(value);
                                    return `${context.dataset.label}: ${formattedValue}`;
                                }
                            }
                        }
                    },
                    interaction: {
                        mode: 'index',
                        intersect: false
                    }
                }
            });
        });
    </script>
</body>
</html>
