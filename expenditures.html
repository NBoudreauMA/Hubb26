<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hubbardston Budget Portal - Expenditures</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            margin: 0;
            padding: 0;
            background: url('hubbardston_bg.jpg') no-repeat center center fixed;
            background-size: cover;
            color: white;
        }
        
        nav {
            background: linear-gradient(90deg, rgba(34, 139, 34, 0.9), rgba(0, 100, 0, 0.9));
            padding: 15px;
            text-align: center;
            display: flex;
            justify-content: space-around;
            align-items: center;
            position: fixed;
            width: 100%;
            top: 0;
            left: 0;
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            z-index: 1000;
        }

        nav a {
            color: white;
            margin: 0 20px;
            text-decoration: none;
            font-size: 22px;
            font-weight: bold;
            text-transform: uppercase;
            transition: 0.3s ease-in-out;
        }

        nav a:hover {
            text-decoration: underline;
            transform: scale(1.2);
            color: white;
            background-color: rgba(0, 100, 0, 0.7);
            border-radius: 5px;
        }
        
        nav a.active {
            color: white;
            text-decoration: underline;
            background-color: rgba(0, 100, 0, 0.7);
            padding: 8px 15px;
            border-radius: 5px;
        }
        
        .container {
            max-width: 1200px;
            margin: 120px auto 40px;
            padding: 30px;
            background: rgba(0, 0, 0, 0.75);
            border-radius: 15px;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(5px);
        }
        
        .content-section {
            margin-bottom: 40px;
            transition: 0.4s ease-in-out;
            padding: 20px;
            border-radius: 10px;
            background: rgba(20, 20, 20, 0.5);
        }
        
        .content-section:hover {
            transform: scale(1.01);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.4);
        }
        
        h2 {
            color: #4bc0c0;
            text-align: center;
            margin-bottom: 30px;
            font-size: 32px;
            font-weight: 600;
            letter-spacing: 1px;
            text-transform: uppercase;
        }
        
        /* Expenditures Header */
        .expenditures-header {
            background: linear-gradient(135deg, rgba(0, 60, 30, 0.85), rgba(0, 90, 70, 0.75));
            border-radius: 12px;
            padding: 35px 40px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            border-left: 4px solid #4bc0c0;
            margin: 35px 0;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(5px);
        }
        
        .expenditures-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at top right, rgba(75, 192, 192, 0.1), transparent 60%);
            z-index: 0;
        }
        
        .expenditures-title {
            color: #4bc0c0;
            text-align: center;
            font-size: 34px;
            margin-bottom: 28px;
            font-weight: 600;
            text-transform: none;
            letter-spacing: 0;
            position: relative;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .expenditures-content {
            color: white;
            font-size: 17px;
            line-height: 1.8;
            position: relative;
        }
        
        .expenditures-content p {
            margin-bottom: 22px;
            opacity: 0.95;
        }
        
        .highlight-number {
            color: #4bc0c0;
            font-weight: 600;
            position: relative;
            padding: 0 2px;
        }
        
        .highlight-number::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 100%;
            height: 1px;
            background-color: rgba(75, 192, 192, 0.4);
        }
        
        /* Charts Section */
        .charts-section {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
            margin-top: 40px;
        }
        
        .chart-box {
            flex: 1;
            min-width: 45%;
            background: linear-gradient(135deg, rgba(0, 60, 30, 0.85), rgba(0, 90, 70, 0.75));
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            border-left: 4px solid #4bc0c0;
            position: relative;
            overflow: hidden;
        }
        
        .chart-box::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at top right, rgba(75, 192, 192, 0.1), transparent 60%);
            z-index: 0;
        }
        
        .chart-title {
            color: #4bc0c0;
            font-size: 24px;
            text-align: center;
            margin-bottom: 25px;
            position: relative;
            z-index: 1;
            font-weight: 600;
        }
        
        .chart-display {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 20px;
            position: relative;
            z-index: 1;
            height: 300px;
        }
        
        /* Department Details */
        .department-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-top: 40px;
        }
        
        .department-card {
            background: linear-gradient(135deg, rgba(0, 60, 30, 0.85), rgba(0, 90, 70, 0.75));
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
            border-left: 4px solid #4bc0c0;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .department-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.25);
        }
        
        .department-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at top right, rgba(75, 192, 192, 0.1), transparent 70%);
            z-index: 0;
        }
        
        .department-title {
            color: #4bc0c0;
            font-size: 22px;
            margin-bottom: 15px;
            position: relative;
            z-index: 1;
        }
        
        .department-amount {
            font-size: 26px;
            font-weight: 600;
            color: white;
            margin-bottom: 15px;
            position: relative;
            z-index: 1;
        }
        
        .department-text {
            color: rgba(255, 255, 255, 0.9);
            line-height: 1.6;
            position: relative;
            z-index: 1;
        }
        
        /* Chart Legend Styling */
        .chart-legend {
            margin-top: 25px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            position: relative;
            z-index: 1;
        }
        
        .legend-item {
            display: grid;
            grid-template-columns: 24px 1fr auto auto;
            gap: 15px;
            align-items: center;
            padding: 12px 15px;
            margin-bottom: 5px;
            border-radius: 6px;
            transition: all 0.3s ease;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .legend-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }
        
        .legend-item:hover {
            background: rgba(75, 192, 192, 0.1);
            transform: translateX(5px);
        }
        
        .legend-color {
            width: 18px;
            height: 18px;
            border-radius: 4px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.15);
        }
        
        .legend-text {
            color: white;
            font-weight: 500;
            font-size: 16px;
        }
        
        .legend-value {
            color: #ffffff;
            text-align: right;
            font-size: 15px;
        }
        
        .legend-percent {
            color: #4bc0c0;
            text-align: right;
            font-weight: 600;
            width: 60px;
            font-size: 15px;
        }
        
        /* Download Button */
        .button-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 40px 0 20px;
            flex-wrap: wrap;
        }
        
        .download-button {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            background: rgba(0, 140, 110, 0.7);
            color: white;
            text-decoration: none;
            padding: 14px 22px;
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
        }
        
        .download-button:hover {
            background: rgba(0, 160, 130, 0.9);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.25);
        }
        
        .download-button:active {
            transform: translateY(1px);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }
        
        .button-icon {
            flex-shrink: 0;
            transition: transform 0.3s ease;
        }
        
        .download-button:hover .button-icon {
            transform: translateY(-2px);
        }
        
        /* Budget Comparison */
        .budget-comparison {
            margin-top: 50px;
            background: linear-gradient(135deg, rgba(0, 60, 30, 0.85), rgba(0, 90, 70, 0.75));
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            border-left: 4px solid #4bc0c0;
            position: relative;
        }
        
        .budget-comparison::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at top right, rgba(75, 192, 192, 0.1), transparent 60%);
            z-index: 0;
        }
        
        .comparison-title {
            color: #4bc0c0;
            font-size: 24px;
            text-align: center;
            margin-bottom: 30px;
            position: relative;
            font-weight: 600;
        }
        
        .comparison-container {
            display: flex;
            justify-content: space-around;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
            position: relative;
        }
        
        .comparison-card {
            flex: 1;
            min-width: 200px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
        }
        
        .year-label {
            color: #4bc0c0;
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 10px;
        }
        
        .amount-label {
            font-size: 24px;
            color: white;
            margin-bottom: 5px;
        }
        
        .change-label {
            font-size: 16px;
            color: #2ecc71;
            font-weight: 500;
        }
        
        .change-label.negative {
            color: #e74c3c;
        }
        
        /* Budget Forecast Section */
        .budget-forecast {
            margin-top: 50px;
            background: linear-gradient(135deg, rgba(0, 60, 30, 0.85), rgba(0, 90, 70, 0.75));
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            border-left: 4px solid #4bc0c0;
            position: relative;
        }
        
        .budget-forecast::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at top right, rgba(75, 192, 192, 0.1), transparent 60%);
            z-index: 0;
        }
        
        .forecast-title {
            color: #4bc0c0;
            font-size: 24px;
            text-align: center;
            margin-bottom: 30px;
            position: relative;
            font-weight: 600;
        }
        
        .forecast-chart {
            height: 400px;
            position: relative;
            z-index: 1;
            margin-bottom: 30px;
        }
        
        .forecast-table {
            overflow-x: auto;
            position: relative;
            z-index: 1;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        th {
            background-color: rgba(0, 0, 0, 0.3);
            color: #4bc0c0;
            font-weight: 600;
            white-space: nowrap;
        }
        
        tr:hover {
            background-color: rgba(75, 192, 192, 0.1);
        }
        
        .category-name {
            font-weight: 500;
        }
        
        .total-row {
            font-weight: 700;
            border-top: 2px solid rgba(255, 255, 255, 0.2);
            background-color: rgba(0, 0, 0, 0.2);
        }
        
        .diff-row {
            font-style: italic;
            color: rgba(255, 255, 255, 0.7);
        }
        
        .increase {
            color: #2ecc71;
        }
        
        /* Responsive Design */
        @media (max-width: 900px) {
            .charts-section, 
            .department-grid,
            .comparison-container {
                flex-direction: column;
            }
            
            .chart-box, 
            .department-card {
                min-width: 100%;
            }
            
            .expenditures-header,
            .chart-box,
            .department-card {
                padding: 25px 20px;
            }
            
            .expenditures-title {
                font-size: 28px;
            }
            
            nav a {
                font-size: 16px;
                margin: 0 10px;
            }
            
            .chart-display {
                height: 250px;
            }
            
            .forecast-table {
                overflow-x: scroll;
            }
        }
    </style>
</head>
<body>
    <nav>
        <a href="index.html">HOME</a>
        <a href="revenue.html">REVENUE</a>
        <a href="expenditures.html" class="active">EXPENDITURES</a>
        <a href="capital_plan.html">CAPITAL PLAN</a>
        <a href="citizens_guide.html">CITIZEN'S GUIDE</a>
    </nav>
    
    <div class="container">
        <div class="content-section">
            <h2>FY26 Expenditures Analysis</h2>
            
            <div class="expenditures-header">
                <h3 class="expenditures-title">Expenditures Overview</h3>
                
                <div class="expenditures-content">
                    <p>The FY26 budget reflects Hubbardston's commitment to responsible fiscal management while addressing key community needs. Total expenditures for FY26 amount to <span class="highlight-number">$11,851,233</span>, representing a carefully planned 6.32% increase over the previous fiscal year.</p>
                    
                    <p>This budget prioritizes education, public safety, and infrastructure while maintaining essential services across all departments. Strategic investments in key areas will enable improvements in service delivery while maintaining long-term fiscal sustainability.</p>
                </div>
            </div>
            
            <!-- Expenditures Chart Section -->
            <div class="charts-section">
                <div class="chart-box">
                    <h3 class="chart-title">Expenditures By Department</h3>
                    <div class="chart-display">
                        <canvas id="departmentChart"></canvas>
                    </div>
                    
                    <div class="chart-legend">
                        <div class="legend-item">
                            <div class="legend-color" style="background-color: #3498db;"></div>
                            <div class="legend-text">Education</div>
                            <div class="legend-value">$7,334,563</div>
                            <div class="legend-percent">61.9%</div>
                        </div>
                        
                        <div class="legend-item">
                            <div class="legend-color" style="background-color: #e74c3c;"></div>
                            <div class="legend-text">Public Safety</div>
                            <div class="legend-value">$1,595,193</div>
                            <div class="legend-percent">13.5%</div>
                        </div>
                        
                        <div class="legend-item">
                            <div class="legend-color" style="background-color: #9b59b6;"></div>
                            <div class="legend-text">Liabilities & Assessments</div>
                            <div class="legend-value">$999,455</div>
                            <div class="legend-percent">8.4%</div>
                        </div>
                        
                        <div class="legend-item">
                            <div class="legend-color" style="background-color: #1abc9c;"></div>
                            <div class="legend-text">Public Works</div>
                            <div class="legend-value">$920,184</div>
                            <div class="legend-percent">7.8%</div>
                        </div>
                        
                        <div class="legend-item">
                            <div class="legend-color" style="background-color: #f1c40f;"></div>
                            <div class="legend-text">General Government</div>
                            <div class="legend-value">$724,886</div>
                            <div class="legend-percent">6.1%</div>
                        </div>
                        
                        <div class="legend-item">
                            <div class="legend-color" style="background-color: #e67e22;"></div>
                            <div class="legend-text">Debt Service</div>
                            <div class="legend-value">$146,862</div>
                            <div class="legend-percent">1.2%</div>
                        </div>
                        
                        <div class="legend-item">
                            <div class="legend-color" style="background-color: #00bcd4;"></div>
                            <div class="legend-text">Culture & Recreation</div>
                            <div class="legend-value">$94,290</div>
                            <div class="legend-percent">0.8%</div>
                        </div>
                        
                       import React, { useState, useEffect } from 'react';

const HubbardstonBudgetVisualization = () => {
  // Budget data
  const budgetData = [
    { name: 'General Government', value: 724886.38, displayValue: '$724,886.38' },
    { name: 'Public Safety', value: 1595193.23, displayValue: '$1,595,193.23' },
    { name: 'Public Works', value: 920184.29, displayValue: '$920,184.29' },
    { name: 'Education', value: 7334562.64, displayValue: '$7,334,562.64' },
    { name: 'Human Services', value: 26950.00, displayValue: '$26,950.00' },
    { name: 'Culture and Recreation', value: 94289.70, displayValue: '$94,289.70' },
    { name: 'Debt', value: 146862.00, displayValue: '$146,862.00' },
    { name: 'Liabilities and Assessments', value: 999454.94, displayValue: '$999,454.94' }
  ];

  // Calculate total budget
  const totalBudget = budgetData.reduce((sum, item) => sum + item.value, 0);

  // Calculate percentages and cents per dollar
  const dataWithPercentage = budgetData.map(item => ({
    ...item,
    percentage: (item.value / totalBudget) * 100,
    centsPerDollar: (item.value / totalBudget)
  }));

  // Sort data by value (highest to lowest)
  const sortedData = [...dataWithPercentage].sort((a, b) => b.value - a.value);

  // Colors for the segments (vibrant colors with good contrast)
  const COLORS = [
    '#E74C3C', '#3498DB', '#27AE60', '#9B59B6', '#F39C12', 
    '#16A085', '#2980B9', '#C0392B'
  ];

  // Format as currency
  const formatCurrency = (value) => {
    return new Intl.NumberFormat('en-US', {
      style: 'currency',
      currency: 'USD',
      minimumFractionDigits: 2
    }).format(value);
  };

  // Format as percentage
  const formatPercentage = (value) => {
    return value.toFixed(1) + '%';
  };

  // Format as cents
  const formatCents = (value) => {
    return (value * 100).toFixed(1) + '¢';
  };

  const [hoveredSegment, setHoveredSegment] = useState(null);
  const [isMobile, setIsMobile] = useState(false);

  // Check viewport width for responsive design
  useEffect(() => {
    const checkMobile = () => {
      setIsMobile(window.innerWidth < 768);
    };
    
    checkMobile();
    window.addEventListener('resize', checkMobile);
    
    return () => {
      window.removeEventListener('resize', checkMobile);
    };
  }, []);

  return (
    <div className="w-full max-w-4xl mx-auto p-4">
      <div className="text-center mb-6">
        <h2 className="text-2xl font-bold mb-2">Town of Hubbardston Budget Breakdown</h2>
        <p className="text-gray-600">Total Budget: {formatCurrency(totalBudget)}</p>
      </div>

      {/* Custom visualization with Hubbardston image */}
      <div className="relative mb-8 mx-auto" style={{ maxWidth: "700px" }}>
        <div className="relative rounded-lg overflow-hidden shadow-2xl" style={{ aspectRatio: "16/9" }}>
          {/* Hubbardston image background */}
          <img 
            src="https://github.com/NBoudreauMA/Hubb26/blob/main/HUBBARDSTON.png?raw=true" 
            alt="Town of Hubbardston" 
            className="absolute inset-0 w-full h-full object-cover"
            style={{
              filter: "contrast(1.05) brightness(1.05)"
            }}
          />
          
          {/* Semi-transparent overlay to make segments more visible */}
          <div className="absolute inset-0 bg-white opacity-60"></div>
          
          {/* Budget data visualization */}
          <div className="absolute inset-0 p-4">
            <div className="h-full w-full rounded-md overflow-hidden shadow-inner border border-gray-300 bg-white bg-opacity-70 flex">
              {sortedData.map((item, index) => (
                <div 
                  key={index}
                  className="h-full transition-all duration-200 flex items-center justify-center relative cursor-pointer"
                  style={{ 
                    width: `${item.percentage}%`,
                    backgroundColor: hoveredSegment === index 
                      ? `${COLORS[index % COLORS.length]}dd` 
                      : `${COLORS[index % COLORS.length]}33`,
                    borderLeft: index > 0 ? '1px solid rgba(0,0,0,0.2)' : 'none',
                  }}
                  onMouseEnter={() => setHoveredSegment(index)}
                  onMouseLeave={() => setHoveredSegment(null)}
                >
                  {/* Department label for larger segments */}
                  {item.percentage > 8 && (
                    <div className={`text-center font-bold transition-all duration-200 ${hoveredSegment === index ? 'text-white scale-110' : 'text-gray-800'}`}>
                      <div className="text-sm md:text-base">{formatCents(item.centsPerDollar)}</div>
                      {item.percentage > 15 && (
                        <div className="text-xs hidden md:block">{item.name}</div>
                      )}
                    </div>
                  )}
                </div>
              ))}
            </div>
            
            {/* Top badge showing "Your Tax Dollar" */}
            <div className="absolute top-0 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-blue-600 text-white px-4 py-1 rounded-full text-sm font-bold shadow-lg">
              Your Tax Dollar
            </div>
          </div>
          
          {/* Tooltip on hover */}
          {hoveredSegment !== null && (
            <div className="absolute top-full mt-2 left-1/2 transform -translate-x-1/2 bg-white p-3 rounded-lg shadow-xl z-30 text-sm" style={{ maxWidth: "280px" }}>
              <div 
                className="w-full h-1 mb-2 rounded-full" 
                style={{ backgroundColor: COLORS[hoveredSegment % COLORS.length] }}
              ></div>
              <div className="font-bold text-base">{sortedData[hoveredSegment].name}</div>
              <div className="grid grid-cols-2 gap-1 mt-1">
                <div className="text-gray-600">Budget amount:</div>
                <div className="font-medium text-right">{formatCurrency(sortedData[hoveredSegment].value)}</div>
                <div className="text-gray-600">Percentage:</div>
                <div className="font-medium text-right">{formatPercentage(sortedData[hoveredSegment].percentage)}</div>
                <div className="text-gray-600">Of each dollar:</div>
                <div className="font-medium text-right">{formatCents(sortedData[hoveredSegment].centsPerDollar)}</div>
              </div>
            </div>
          )}
        </div>
        <div className="text-center text-sm text-gray-500 mt-2">
          Hover/tap on segments to see department details
        </div>
      </div>

      {/* Color-coded legend */}
      <div className="flex flex-wrap justify-center gap-x-6 gap-y-2 mb-8">
        {sortedData.map((item, index) => (
          <div 
            key={index}
            className={`flex items-center gap-2 cursor-pointer transition-all duration-200 p-1 rounded ${hoveredSegment === index ? 'bg-gray-100 scale-110' : ''}`}
            onMouseEnter={() => setHoveredSegment(index)}
            onMouseLeave={() => setHoveredSegment(null)}
          >
            <div 
              className="w-5 h-5 rounded shadow-sm" 
              style={{ backgroundColor: COLORS[index % COLORS.length] }}
            ></div>
            <div className="text-sm">
              <span className="font-medium">{item.name}</span>
              <span className="text-gray-600 ml-1">({formatCents(item.centsPerDollar)})</span>
            </div>
          </div>
        ))}
      </div>
        
      {/* Budget breakdown table */}
      <div className="mx-auto rounded-lg overflow-hidden shadow-lg border border-gray-200" style={{ maxWidth: "700px" }}>
        <table className="min-w-full divide-y divide-gray-200">
          <thead className="bg-gray-50">
            <tr>
              <th className="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Department</th>
              <th className="px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Amount</th>
              <th className="px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Percentage</th>
              <th className="px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">¢ per $</th>
            </tr>
          </thead>
          <tbody className="bg-white divide-y divide-gray-200">
            {sortedData.map((item, index) => (
              <tr 
                key={index} 
                className={`hover:bg-gray-50 ${hoveredSegment === index ? 'bg-gray-100' : ''}`}
                onMouseEnter={() => setHoveredSegment(index)}
                onMouseLeave={() => setHoveredSegment(null)}
              >
                <td className="px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900">
                  <div className="flex items-center">
                    <div 
                      className="w-4 h-4 rounded-sm mr-2 shadow-sm" 
                      style={{ backgroundColor: COLORS[index % COLORS.length] }}
                    ></div>
                    {item.name}
                  </div>
                </td>
                <td className="px-4 py-3 whitespace-nowrap text-sm text-gray-500 text-right">{formatCurrency(item.value)}</td>
                <td className="px-4 py-3 whitespace-nowrap text-sm text-gray-500 text-right">{formatPercentage(item.percentage)}%</td>
                <td className="px-4 py-3 whitespace-nowrap text-sm text-gray-500 text-right font-medium">{formatCents(item.centsPerDollar)}</td>
              </tr>
            ))}
          </tbody>
          <tfoot className="bg-gray-50">
            <tr>
              <td className="px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider">Total</td>
              <td className="px-4 py-3 text-right text-xs font-medium text-gray-700 uppercase tracking-wider">{formatCurrency(totalBudget)}</td>
              <td className="px-4 py-3 text-right text-xs font-medium text-gray-700 uppercase tracking-wider">100.0%</td>
              <td className="px-4 py-3 text-right text-xs font-medium text-gray-700 uppercase tracking-wider">$1.00</td>
            </tr>
          </tfoot>
        </table>
      </div>
    </div>
  );
};

export default HubbardstonBudgetVisualization;
            
            <!-- Department Details -->
            <div class="department-grid">
                <div class="department-card">
                    <h3 class="department-title">Education</h3>
                    <div class="department-amount">$7,334,563</div>
                    <p class="department-text">Our largest expenditure category supports the Quabbin Regional School District, covering educational services, operations, and special education requirements. The FY26 budget includes funding for educational programming, maintenance, and the district assessment.</p>
                </div>
                
                <div class="department-card">
                    <h3 class="department-title">Public Safety</h3>
                    <div class="department-amount">$1,595,193</div>
                    <p class="department-text">Includes funding for Police and Fire Departments, Emergency Management, and Animal Control. The FY26 increases support equipment upgrades, training, and staffing adjustments to ensure adequate emergency response capabilities.</p>
                </div>
                
                <div class="department-card">
                    <h3 class="department-title">Liabilities & Assessments</h3>
                    <div class="department-amount">$999,455</div>
                    <p class="department-text">Covers employee benefits, insurance, and other municipal liabilities. This category includes health insurance, retirement contributions, and other post-employment benefits (OPEB) funding to address long-term obligations.</p>
                </div>
                
                <div class="department-card">
                    <h3 class="department-title">Public Works</h3>
                    <div class="department-amount">$920,184</div>
                    <p class="department-text">Funds road maintenance, snow removal, equipment maintenance, and other infrastructure needs. The FY26 budget includes increased investments in road repair materials and equipment replacements.</p>
                </div>
            </div>
            
            <!-- Budget Comparison -->
            <div class="budget-comparison">
                <h3 class="comparison-title">Budget Comparison: FY25 vs. FY26</h3>
                
                <div class="comparison-container">
                    <div class="comparison-card">
                        <div class="year-label">FY25 Budget</div>
                        <div class="amount-label">$11,146,879</div>
                    </div>
                    
                    <div class="comparison-card">
                        <div class="year-label">FY26 Budget</div>
                        <div class="amount-label">$11,851,233</div>
                        <div class="change-label">+6.32%</div>
                    </div>
                    
                    <div class="comparison-card">
                        <div class="year-label">Net Increase</div>
                        <div class="amount-label">$704,354</div>
                    </div>
                </div>
            </div>
            
            <!-- Budget Forecast -->
            <div class="budget-forecast">
                <h3 class="forecast-title">Five-Year Budget Forecast (FY26-FY30)</h3>
                
                <div class="forecast-chart">
                    <canvas id="forecastChart"></canvas>
                </div>
                
                <div class="forecast-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Category</th>
                                <th>FY25</th>
                                <th>FY26</th>
                                <th>FY27</th>
                                <th>FY28</th>
                                <th>FY29</th>
                                <th>FY30</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="category-name">Personnel (Town)</td>
                                <td>$2,156,210</td>
                                <td>$2,214,752</td>
                                <td>$2,275,757</td>
                                <td>$2,338,489</td>
                                <td>$2,402,998</td>
                                <td>$2,469,542</td>
                            </tr>
                            <tr>
                                <td class="category-name">Services (Town)</td>
                                <td>$168,618</td>
                                <td>$171,729</td>
                                <td>$174,362</td>
                                <td>$177,059</td>
                                <td>$179,821</td>
                                <td>$182,896</td>
                            </tr>
                            <tr>
                                <td class="category-name">Facilities, Utilities, Gear, Supplies, and Capital</td>
                                <td>$755,459</td>
                                <td>$766,099</td>
                                <td>$786,171</td>
                                <td>$806,815</td>
                                <td>$828,049</td>
                                <td>$850,107</td>
                            </tr>
                            <tr>
                                <td class="category-name">Education</td>
                                <td>$6,784,230</td>
                                <td>$7,334,563</td>
                                <td>$7,566,285</td>
                                <td>$7,937,654</td>
                                <td>$8,327,402</td>
                                <td>$8,736,444</td>
                            </tr>
                            <tr>
                                <td class="category-name">Liabilities (Insurances and Assessments)</td>
                                <td>$1,036,256</td>
                                <td>$999,455</td>
                                <td>$1,138,701</td>
                                <td>$1,036,256</td>
                                <td>$999,455</td>
                                <td>$1,138,701</td>
                                <td>$1,186,745</td>
                                <td>$1,236,966</td>
                                <td>$1,289,466</td>
                            </tr>
                            <tr>
                                <td class="category-name">Debt</td>
                                <td>$146,862</td>
                                <td>$146,862</td>
                                <td>$157,681</td>
                                <td>$160,834</td>
                                <td>$164,051</td>
                                <td>$167,332</td>
                            </tr>
                            <tr class="total-row">
                                <td class="category-name">TOTAL</td>
                                <td>$11,047,636</td>
                                <td>$11,851,233</td>
                                <td>$12,098,956</td>
                                <td>$12,607,597</td>
                                <td>$13,139,288</td>
                                <td>$13,695,787</td>
                            </tr>
                            <tr class="diff-row">
                                <td class="category-name">Annual Increase</td>
                                <td>-</td>
                                <td>$803,597</td>
                                <td>$247,723</td>
                                <td>$508,640</td>
                                <td>$531,692</td>
                                <td>$556,498</td>
                            </tr>
                            <tr class="diff-row">
                                <td class="category-name">Annual % Increase</td>
                                <td>-</td>
                                <td>7.27%</td>
                                <td>2.09%</td>
                                <td>4.20%</td>
                                <td>4.22%</td>
                                <td>4.23%</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Download Buttons -->
            <div class="button-container">
                <a href="budget.pdf" target="_blank" class="download-button">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="button-icon">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                        <polyline points="7 10 12 15 17 10"></polyline>
                        <line x1="12" y1="15" x2="12" y2="3"></line>
                    </svg>
                    Download Budget Report
                </a>
                
                <a href="budget_view.html" target="_blank" class="download-button">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="button-icon">
                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                        <line x1="9" y1="3" x2="9" y2="21"></line>
                        <line x1="15" y1="3" x2="15" y2="21"></line>
                        <line x1="3" y1="9" x2="21" y2="9"></line>
                        <line x1="3" y1="15" x2="21" y2="15"></line>
                    </svg>
                    Review Budget Spreadsheet
                </a>
            </div>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Set consistent colors for department categories
            const departmentColors = {
                education: '#3498db',
                publicSafety: '#e74c3c',
                liabilities: '#9b59b6',
                publicWorks: '#1abc9c',
                generalGov: '#f1c40f',
                debt: '#e67e22',
                culture: '#00bcd4',
                humanServices: '#ff80ab'
            };
            
            // Department Expenditures Chart
            const deptCtx = document.getElementById('departmentChart').getContext('2d');
            new Chart(deptCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Education', 'Public Safety', 'Liabilities & Assessments', 'Public Works', 'General Government', 'Debt Service', 'Culture & Recreation', 'Human Services'],
                    datasets: [{
                        data: [7334563, 1595193, 999455, 920184, 724886, 146862, 94290, 26950],
                        backgroundColor: [
                            departmentColors.education,
                            departmentColors.publicSafety,
                            departmentColors.liabilities,
                            departmentColors.publicWorks, 
                            departmentColors.generalGov,
                            departmentColors.debt,
                            departmentColors.culture,
                            departmentColors.humanServices
                        ],
                        borderWidth: 0,
                        hoverOffset: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const value = context.raw;
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const percentage = Math.round((value / total * 100) * 10) / 10;
                                    const formattedValue = new Intl.NumberFormat('en-US', {
                                        style: 'currency',
                                        currency: 'USD',
                                        maximumFractionDigits: 0
                                    }).format(value);
                                    return `${context.label}: ${formattedValue} (${percentage}%)`;
                                }
                            }
                        }
                    },
                    cutout: '60%',
                    animation: {
                        animateScale: true,
                        animateRotate: true
                    }
                }
            });
            
            // Year-over-Year Changes Chart
            const changesCtx = document.getElementById('changesChart').getContext('2d');
            new Chart(changesCtx, {
                type: 'bar',
                data: {
                    labels: ['Education', 'Public Safety', 'Liabilities', 'Public Works', 'General Gov'],
                    datasets: [{
                        label: 'FY26 Increase',
                        data: [550333, 50902, 36801, 34142, 25306],
                        backgroundColor: [
                            departmentColors.education,
                            departmentColors.publicSafety,
                            departmentColors.liabilities,
                            departmentColors.publicWorks,
                            departmentColors.generalGov
                        ],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            ticks: {
                                color: '#ffffff',
                                callback: function(value) {
                                    return '$' + value.toLocaleString();
                                }
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                color: '#ffffff'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const value = context.raw;
                                    const formattedValue = new Intl.NumberFormat('en-US', {
                                        style: 'currency',
                                        currency: 'USD',
                                        maximumFractionDigits: 0
                                    }).format(value);
                                    return `Increase: ${formattedValue}`;
                                }
                            }
                        }
                    },
                    animation: {
                        animateScale: true
                    }
                }
            });
            
            // Five-Year Forecast Chart
            const forecastCtx = document.getElementById('forecastChart').getContext('2d');
            new Chart(forecastCtx, {
                type: 'line',
                data: {
                    labels: ['FY25', 'FY26', 'FY27', 'FY28', 'FY29', 'FY30'],
                    datasets: [
                        {
                            label: 'Education',
                            data: [6784230, 7334563, 7566285, 7937654, 8327402, 8736444],
                            borderColor: departmentColors.education,
                            backgroundColor: 'rgba(52, 152, 219, 0.1)',
                            fill: true,
                            tension: 0.4,
                            borderWidth: 3
                        },
                        {
                            label: 'Personnel',
                            data: [2156210, 2214752, 2275757, 2338489, 2402998, 2469542],
                            borderColor: departmentColors.publicSafety,
                            backgroundColor: 'rgba(231, 76, 60, 0.1)',
                            fill: true,
                            tension: 0.4,
                            borderWidth: 3
                        },
                        {
                            label: 'Liabilities',
                            data: [1036256, 999455, 1138701, 1186745, 1236966, 1289466],
                            borderColor: departmentColors.liabilities,
                            backgroundColor: 'rgba(155, 89, 182, 0.1)',
                            fill: true,
                            tension: 0.4,
                            borderWidth: 3
                        },
                        {
                            label: 'Facilities & Supplies',
                            data: [755459, 766099, 786171, 806815, 828049, 850107],
                            borderColor: departmentColors.publicWorks,
                            backgroundColor: 'rgba(26, 188, 156, 0.1)',
                            fill: true,
                            tension: 0.4,
                            borderWidth: 3
                        },
                        {
                            label: 'Total Budget',
                            data: [11047636, 11851233, 12098956, 12607597, 13139288, 13695787],
                            borderColor: '#4bc0c0',
                            backgroundColor: 'rgba(75, 192, 192, 0.1)',
                            borderDash: [5, 5],
                            borderWidth: 3,
                            fill: false,
                            tension: 0.4,
                            pointRadius: 5,
                            pointHoverRadius: 8
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            ticks: {
                                color: '#ffffff',
                                callback: function(value) {
                                    if (value >= 1000000) {
                                        return '$' + (value / 1000000).toFixed(1) + 'M';
                                    }
                                    return '$' + value.toLocaleString();
                                }
                            }
                        },
                        x: {
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            ticks: {
                                color: '#ffffff'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                color: '#ffffff',
                                font: {
                                    family: 'Poppins',
                                    size: 12
                                },
                                boxWidth: 12
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const value = context.raw;
                                    const formattedValue = new Intl.NumberFormat('en-US', {
                                        style: 'currency',
                                        currency: 'USD',
                                        maximumFractionDigits: 0
                                    }).format(value);
                                    return `${context.dataset.label}: ${formattedValue}`;
                                }
                            }
                        }
                    },
                    interaction: {
                        mode: 'index',
                        intersect: false
                    }
                }
            });
        });
    </script>
</body>
</html>
